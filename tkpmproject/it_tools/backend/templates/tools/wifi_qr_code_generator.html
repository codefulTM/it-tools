{% extends 'master.html' %}

{% block content %}
<h2 class="tool-name">WiFi QR Code Generator</h2>

<p class="tool-des">
    Generate QR code to quickly connect to WiFi networks.
    <br> Just enter the SSID and password, and the QR code will be generated for you.
</p>

<form action="/generate_qr_code/" method="post">
    <div class="tool-body qr-code-generator-container">
        {% csrf_token %}
        <label class="normal-label-down">Encryption method:</label>
        <select name="encryption-method" class="dropdown" id="encryption">
            <option value="no">No password</option>
            <option value="wpa" selected>WPA/WPA2</option>
            <option value="wep">WEP</option>
            <option value="eap">WPA2-EAP</option>
        </select>

        <label class="normal-label">SSID:</label>
        <input class="normal-input" type="text" required>
        
        <label class="normal-label" id="label-password">Password:</label>
        <input class="normal-input" type="password" id="input-password" required>
    
        <label class="normal-label-down">Foreground color:</label>
        <div class="color-picker-wrapper">
            <input type="color" id="input-foreground" value="#000000">
            <input type="text" id="foreground-hex" class="hex-value" readonly>
        </div>

        <label class="normal-label-down">Background color:</label>
        <div class="color-picker-wrapper">
            <input type="color" id="input-background" value="#ffffff">
            <input type="text" id="background-hex" class="hex-value" readonly>
        </div>

        <label class="normal-label">Hidden SSID</label>
        <input type="checkbox" name="hidden-ssid" checked="checked">
    </div>  

    <span>
        <input type="submit" value="Generate QR Code" class="normal-btn">
        <input type="button" value="Download QR Code" class="normal-btn">
    </span>
</form>

<script>
    const foregroundColorInput = document.getElementById('input-foreground');
    const backgroundColorInput = document.getElementById('input-background');

    const foregroundHex = document.getElementById('foreground-hex');
    const backgroundHex = document.getElementById('background-hex');

    const encryptionValue = document.getElementById('encryption');

    const passwordLabel = document.getElementById('label-password');
    const passwordInput = document.getElementById('input-password');

    function updateForegroundColor(hex) {
        foregroundHex.value = hex;
    }

    foregroundColorInput.addEventListener('input', (e) => {
        updateForegroundColor(e.target.value);
    });

    updateForegroundColor(foregroundColorInput.value);

    function updateBackgroundColor(hex) {
        backgroundHex.value = hex;
    }

    backgroundColorInput.addEventListener('input', (e) => {
        updateBackgroundColor(e.target.value);
    });

    updateBackgroundColor(backgroundColorInput.value);

    encryptionValue.addEventListener('change', (e) => {
        changeEncryption();
    });
    
    function changeEncryption() {
        if (encryptionValue.value == "no") {
            passwordInput.value = "";
            passwordInput.disabled = true;
            passwordInput.removeAttribute('required');
            passwordInput.setAttribute('hidden', true);
            passwordLabel.setAttribute('hidden', true);
        } else {
            passwordInput.disabled = false;
            passwordInput.setAttribute('required', true);
            passwordInput.removeAttribute('hidden');
            passwordLabel.removeAttribute('hidden');
        }
    }
</script>
{% endblock %}